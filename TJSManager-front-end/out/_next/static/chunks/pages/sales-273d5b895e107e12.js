(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[173],{4267:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(7462),o=r(3366),a=r(7294),l=(r(5697),r(6010)),i=r(7463),s=r(1496),u=r(3616),c=r(1420);function m(e){return(0,c.Z)("MuiCardContent",e)}(0,r(1271).Z)("MuiCardContent",["root"]);var f=r(5893);const d=["className","component"],v=(0,s.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}})));var y=a.forwardRef((function(e,t){const r=(0,u.Z)({props:e,name:"MuiCardContent"}),{className:a,component:s="div"}=r,c=(0,o.Z)(r,d),y=(0,n.Z)({},r,{component:s}),h=(e=>{const{classes:t}=e;return(0,i.Z)({root:["root"]},m,t)})(y);return(0,f.jsx)(v,(0,n.Z)({as:s,className:(0,l.Z)(h.root,a),ownerState:y,ref:t},c))}))},6242:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var n=r(7462),o=r(3366),a=r(7294),l=(r(5697),r(6010)),i=r(7463),s=r(1496),u=r(3616),c=r(5113),m=r(1420);function f(e){return(0,m.Z)("MuiCard",e)}(0,r(1271).Z)("MuiCard",["root"]);var d=r(5893);const v=["className","raised"],y=(0,s.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"})));var h=a.forwardRef((function(e,t){const r=(0,u.Z)({props:e,name:"MuiCard"}),{className:a,raised:s=!1}=r,c=(0,o.Z)(r,v),m=(0,n.Z)({},r,{raised:s}),h=(e=>{const{classes:t}=e;return(0,i.Z)({root:["root"]},f,t)})(m);return(0,d.jsx)(y,(0,n.Z)({className:(0,l.Z)(h.root,a),elevation:s?8:void 0,ref:t,ownerState:m},c))}))},6724:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sales",function(){return r(1499)}])},1911:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var n=[{savePoint:500,usedPoint:0,salesNum:17,customerNum:14}]},8473:function(e,t,r){"use strict";r.d(t,{n:function(){return n}});var n="http://54.180.125.89:8080"},1499:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return K}});var n=r(5893),o=r(9008),a=r(7357),l=r(7948),i=r(5861),s=r(6886),u=r(6242),c=r(4267),m=r(7294),f=r(9669),d=r.n(f),v=r(8473);function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var p=function(e){var t=e.salesCnts,r=e.pointToUse,o=h(e,["salesCnts","pointToUse"]),l=(0,m.useState)({}),f=l[0],p=l[1];(0,m.useEffect)((function(){p(void d().get(v.n+"/item/stock").then((function(e){var t={},r=JSON.parse(sessionStorage.getItem("employee")),n=!0,o=!1,a=void 0;try{for(var l,i=e.data[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;s.primaryKey.storeNum.storeNum==r.storeNum.storeNum&&(t[s.primaryKey.itemNum.itemNum]=s)}}catch(u){o=!0,a=u}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}p(t)})))}),[]);var x=(0,m.useState)({}),b=x[0],g=x[1];(0,m.useEffect)((function(){g(function(e,t){var r={},n=!0,o=!1,a=void 0;try{for(var l,i=Object.keys(e)[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value,u=e[s],c=t[s];if(void 0===c)break;switch(c.event){case"2+1":r[s]=2*Math.floor(u/3)+u%3;break;case"1+1":r[s]=1*Math.floor(u/2)+u%2;break;case"":case null:r[s]=u}}}catch(m){o=!0,a=m}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return r}(t,f))}),[t,f]);var j=(0,m.useState)(0),Z=j[0],N=j[1];return(0,m.useEffect)((function(){N(function(e,r){var n=0,o=!0,a=!1,l=void 0;try{for(var i,s=Object.keys(t)[Symbol.iterator]();!(o=(i=s.next()).done);o=!0){var u=i.value,c=r[u];if(void 0===c){n=void 0;break}n+=e[u]*((100-c.sale)/100*c.primaryKey.itemNum.consumerPrice)}}catch(m){a=!0,l=m}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return n}(b,f))}),[b]),(0,n.jsx)(u.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){y(e,t,r[t])}))}return e}({},o,{children:(0,n.jsx)(c.Z,{children:(0,n.jsxs)(a.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"column"},children:[(0,n.jsx)(i.Z,{color:"textPrimary",gutterBottom:!0,variant:"h5",children:void 0!=Z?Z-r+"\uffe6":"..."}),Object.keys(t).map((function(e){return(0,n.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(s.ZP,{item:!0,lg:6,md:6,xs:6,children:(0,n.jsx)(i.Z,{color:"textSecondary",variant:"body2",children:void 0!=f[e]?f[e].primaryKey.itemNum.itemName:"..."})}),(0,n.jsx)(s.ZP,{item:!0,lg:3,md:3,xs:3,children:(0,n.jsx)(i.Z,{color:"textSecondary",variant:"body2",children:void 0!=b[e]?"\xd7"+b[e]+(b[e]==t[e]?"":"(+"+(t[e]-b[e])+")"):"..."})}),(0,n.jsx)(s.ZP,{item:!0,lg:3,md:3,xs:3,children:(0,n.jsx)(i.Z,{color:"textSecondary",variant:"body2",children:void 0!=f[e]&&void 0!=b[e]?b[e]*((100-f[e].sale)/100*f[e].primaryKey.itemNum.consumerPrice)+"\uffe6"+(0==f[e].sale?"":"(-"+f[e].sale+"%)"):"..."})})]},e)})),r>0&&(0,n.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(s.ZP,{item:!0,lg:6,md:6,xs:6,children:(0,n.jsx)(i.Z,{color:"textSecondary",variant:"body2",children:"\uc0ac\uc6a9\ud560 \ud3ec\uc778\ud2b8"})}),(0,n.jsx)(s.ZP,{item:!0,lg:3,md:3,xs:3,children:(0,n.jsx)(i.Z,{color:"textSecondary",variant:"body2"})}),(0,n.jsx)(s.ZP,{item:!0,lg:3,md:3,xs:3,children:(0,n.jsx)(i.Z,{color:"textSecondary",variant:"body2",children:"-"+r+"\uffe6"})})]})]})})}))},x=r(8445),b=r(7720),g=r(7798),j=r(1057),Z=r(1163),N=r(1911);function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){S(e,t,r[t])}))}return e}function O(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function w(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var C=[{value:"",label:""},{value:"m",label:"m"},{value:"f",label:"f"}],k=[{value:"",label:""},{value:"0",label:"10\ub300 \ubbf8\ub9cc"},{value:"1",label:"10\ub300"},{value:"2",label:"20\ub300"},{value:"3",label:"30\ub300"},{value:"4",label:"40\ub300"},{value:"5",label:"50\ub300"},{value:"6",label:"60\ub300"},{value:"7",label:"70\ub300 \uc774\uc0c1"}],T=function(e){var t=function(e,t,r){var n=!0,o=!1,a=void 0;try{for(var l,i=["consumerGender","consumerAge"][Symbol.iterator]();!(n=(l=i.next()).done);n=!0){if(""==e[l.value])return!1}}catch(d){o=!0,a=d}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}var s=!0,u=!1,c=void 0;try{for(var m,f=["pointToUse"][Symbol.iterator]();!(s=(m=f.next()).done);s=!0){if(""==t[m.value])return!1}}catch(d){u=!0,c=d}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}return r.length>0},r=e.salesCnts,o=e.setSalesCnts,l=(e.pointToUse,e.setPointToUse,O(e,["salesCnts","setSalesCnts","pointToUse","setPointToUse"])),i=(0,m.useState)([]),f=i[0],y=i[1];d().get(v.n+"/membership/customer").then((function(e){var t=[];t.push({value:"",label:""});var r=!0,n=!1,o=void 0;try{for(var a,l=e.data[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var i=a.value;t.push({value:i.customerNum,label:i.customerNum+"("+i.customerName+")"})}}catch(s){n=!0,o=s}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}y(t)}));var h=(0,m.useState)([]),p=h[0],T=h[1];(0,m.useEffect)((function(){d().get(v.n+"/item/stock").then((function(e){var t=[];t.push({value:"",label:""});var r=JSON.parse(sessionStorage.getItem("employee")),n=!0,o=!1,a=void 0;try{for(var l,i=e.data[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;s.primaryKey.storeNum.storeNum==r.storeNum.storeNum&&t.push({value:s.primaryKey.itemNum.itemNum,label:s.primaryKey.itemNum.itemNum+"("+s.primaryKey.itemNum.itemName+")"})}}catch(u){o=!0,a=u}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}T(t)}))}),[]);var E=(0,m.useState)({salesNum:null,consumerGender:"",consumerAge:"",memo:""}),M=E[0],K=E[1],_=(0,m.useState)({customerNum:"",salesNum:void 0,usedPoint:void 0,savePoint:void 0}),A=_[0],U=_[1],I=(0,m.useState)([]),G=I[0],R=I[1];(0,m.useEffect)((function(){o(function(e){var t={},r=!0,n=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var i=a.value;void 0===t[i]&&(t[i]=0),t[i]++}}catch(s){n=!0,o=s}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return t}(G))}),[G]);var W=(0,m.useState)({}),J=W[0],D=W[1];(0,m.useEffect)((function(){console.log("getCost()"),d().get(v.n+"/item/stock").then((function(e){var t={},r=JSON.parse(sessionStorage.getItem("employee")),n=!0,o=!1,a=void 0;try{for(var l,i=e.data[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;s.primaryKey.storeNum.storeNum==r.storeNum.storeNum&&(t[s.primaryKey.itemNum.itemNum]=s)}}catch(u){o=!0,a=u}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}D(t)}))}),[]);var q=(0,m.useState)(t(M,A,G)),V=q[0],B=q[1];(0,m.useEffect)((function(){B(t(M,A,G))}),[M,A,G]);var X=function(e){new Set([]).has(e.target.name)&&""!=e.target.value&&(e.target.value=Math.abs(e.target.value)),K(P({},M,S({},e.target.name,e.target.value)))},F=(0,Z.useRouter)();return(0,n.jsx)("form",P({onSubmit:function(e){e.preventDefault(),d().post(v.n+"/sales/consumer",M).then((function(e){var t=e.data;!function(e,t){var r=JSON.parse(sessionStorage.getItem("employee")),n=!0,o=!1,a=void 0;try{for(var l,i=Object.keys(t)[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;d().post(v.n+"/sales/record",{salesNum:e,itemNum:s,storeNum:r.storeNum.storeNum,salesCnt:t[s]})}}catch(u){o=!0,a=u}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}}(t,r),function(e,t,r){d().post(v.n+"/membership/customer_record",{customerNum:e.customerNum,salesNum:t,usedPoint:0,savePoint:.1*r})}(A,t,function(e,t){var r=0,n=!0,o=!1,a=void 0;try{for(var l,i=Object.keys(e)[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;console.log("itemNum: "+s),console.log(t);var u=t[s];console.log("itemStock: "+u);var c=e[s];console.log("salesCnt: "+c);var m=void 0;switch(u.event){case"2+1":m=2*Math.floor(c/3)+c%3;break;case"1+1":m=1*Math.floor(c/2)+c%2;break;case"":case null:m=c}console.log(m),r+=m*((100-u.sale)/100*u.primaryKey.itemNum.consumerPrice),console.log("cost+= "+m*((100-u.sale)/100*u.primaryKey.itemNum.consumerPrice))}}catch(f){o=!0,a=f}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return console.log("cost: "+r),r}(r,J))})),F.push("/statistics?target=all")},autoComplete:"off",noValidate:!0},l,{children:(0,n.jsxs)(u.Z,{children:[(0,n.jsx)(x.Z,{title:"\uad6c\ub9e4\uc790"}),(0,n.jsx)(b.Z,{}),(0,n.jsx)(c.Z,{children:(0,n.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(s.ZP,{item:!0,md:6,xs:12,children:(0,n.jsx)(g.Z,{error:""==M.consumerGender,fullWidth:!0,helperText:""==M.consumerGender?"\uad6c\ub9e4\uc790 \uc131\ubcc4\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694":"",label:"\uad6c\ub9e4\uc790 \uc131\ubcc4",name:"consumerGender",onChange:X,required:!0,select:!0,SelectProps:{native:!0},value:M.consumerGender,variant:"outlined",children:C.map((function(e){return(0,n.jsx)("option",{value:e.value,children:e.label},e.value)}))})}),(0,n.jsx)(s.ZP,{item:!0,md:6,xs:12,children:(0,n.jsx)(g.Z,{error:""==M.consumerAge,fullWidth:!0,helperText:""==M.consumerAge?"\uad6c\ub9e4\uc790 \ub098\uc774\ub300\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694":"",label:"\uad6c\ub9e4\uc790 \ub098\uc774\ub300",name:"consumerAge",onChange:X,required:!0,select:!0,SelectProps:{native:!0},value:M.consumerAge,variant:"outlined",children:k.map((function(e){return(0,n.jsx)("option",{value:e.value,children:e.label},e.value)}))})}),(0,n.jsx)(s.ZP,{item:!0,md:6,xs:12,children:(0,n.jsx)(g.Z,{fullWidth:!0,label:"\ud310\ub9e4 \uba54\ubaa8",name:"memo",onChange:X,value:M.memo,variant:"outlined"})})]})}),(0,n.jsx)(b.Z,{}),(0,n.jsx)(x.Z,{title:"\uba64\ubc84\uc27d \uace0\uac1d"}),(0,n.jsx)(b.Z,{}),(0,n.jsx)(c.Z,{children:(0,n.jsx)(s.ZP,{container:!0,spacing:3,children:(0,n.jsx)(s.ZP,{item:!0,md:6,xs:12,children:(0,n.jsx)(g.Z,{fullWidth:!0,label:"\uba64\ubc84\uc27d \uace0\uac1d \ubc88\ud638",name:"customerNum",onChange:function(e){new Set(["pointToUse"]).has(e.target.name)&&""!=e.target.value&&(e.target.value=Math.abs(e.target.value)),U(P({},M,S({},e.target.name,e.target.value)))},select:!0,SelectProps:{native:!0},value:N.V.customerNum,variant:"outlined",children:f.map((function(e){return(0,n.jsx)("option",{value:e.value,children:e.label},e.value)}))})})})}),(0,n.jsx)(b.Z,{}),(0,n.jsx)(x.Z,{title:"\ud310\ub9e4 \ubb3c\ud488"}),(0,n.jsx)(b.Z,{}),(0,n.jsx)(c.Z,{children:(0,n.jsx)(s.ZP,{container:!0,spacing:3,children:w(G).concat([""]).map((function(e,t){return(0,n.jsx)(s.ZP,{item:!0,md:6,xs:12,children:(0,n.jsx)(g.Z,{error:0==G.length&&""==e,fullWidth:!0,helperText:0==G.length&&""==e?"\ud310\ub9e4 \ubb3c\ud488 \ubc88\ud638\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694":"",label:"\ud310\ub9e4 \ubb3c\ud488 \ubc88\ud638",name:"itemNum",onChange:function(e){!function(e,t){var r=w(G);""!=e.target.value?(t==G.length-1&&r.push(""),r[t]=e.target.value):r.splice(t,1),R(r)}(e,t)},required:1==G.length,select:!0,SelectProps:{native:!0},value:e,variant:"outlined",children:p.map((function(e){return(0,n.jsx)("option",{value:e.value,children:e.label},e.value)}))})},t)}))})}),(0,n.jsx)(b.Z,{}),(0,n.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"flex-end",p:2},children:[(0,n.jsx)(j.Z,{color:"secondary",variant:"contained",sx:{mr:1},onClick:function(){return history.back()},children:"\ub4a4\ub85c\uac00\uae30"}),(0,n.jsx)(j.Z,{color:"primary",disabled:!V,type:"submit",variant:"contained",children:"\uae30\ubcf8 \uc815\ubcf4 \uc800\uc7a5"})]})]})}))},E=r(6447),M=function(){var e=(0,m.useState)({}),t=e[0],r=e[1],u=(0,m.useState)(0),c=u[0],f=u[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.default,{children:(0,n.jsx)("title",{children:"\ud310\ub9e4 | TJSManager"})}),(0,n.jsx)(a.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,n.jsxs)(l.Z,{maxWidth:"lg",children:[(0,n.jsx)(i.Z,{sx:{mb:3},variant:"h4",children:"\ud310\ub9e4"}),(0,n.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(s.ZP,{item:!0,lg:4,md:6,xs:12,children:(0,n.jsx)(p,{salesCnts:t,pointToUse:c})}),(0,n.jsx)(s.ZP,{item:!0,lg:8,md:6,xs:12,children:(0,n.jsx)(T,{salesCnts:t,setSalesCnts:r,pointToUse:c,setPointToUse:f})})]})]})})]})};M.getLayout=function(e){return(0,n.jsx)(E.c,{children:e})};var K=M}},function(e){e.O(0,[63,694,273,37,669,1,447,774,888,179],(function(){return t=6724,e(e.s=t);var t}));var t=e.O();_N_E=t}]);